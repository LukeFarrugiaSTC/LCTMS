CREATE TABLE IF NOT EXISTS roles (
    roleId INT AUTO_INCREMENT PRIMARY KEY,
    role_name VARCHAR(150) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE IF NOT EXISTS towns (
    townCode VARCHAR(4) NOT NULL PRIMARY KEY,
    townName VARCHAR(100) NOT NULL,
    districtCode VARCHAR(2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE IF NOT EXISTS streets (
    streetCode INT AUTO_INCREMENT PRIMARY KEY,
    townCode VARCHAR(4) NOT NULL,
    streetName VARCHAR(150) NOT NULL,
    streetLongitude DECIMAL(10,8) DEFAULT NULL,
    streetLatitude DECIMAL(10,8) DEFAULT NULL,
    FOREIGN KEY (townCode) REFERENCES towns(townCode)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    userEmail VARCHAR(255) NOT NULL UNIQUE,
    userFirstname VARCHAR(100) NOT NULL,
    userLastname VARCHAR(100) NOT NULL,
    userAddress VARCHAR(255),
    streetCode INT,
    townCode VARCHAR(4),
    userDob DATE,
    userMobile VARCHAR(20),
    userPassword VARCHAR(255) NOT NULL,
    userPin INT(11),
    roleId INT DEFAULT 3,
    isActive TINYINT DEFAULT 1,
    createdDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (roleId) REFERENCES roles(roleId),
    FOREIGN KEY (streetCode) REFERENCES streets(streetCode),
    FOREIGN KEY (townCode) REFERENCES towns(townCode)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE IF NOT EXISTS destinations (
    destinationId INT AUTO_INCREMENT PRIMARY KEY,
    destination_name VARCHAR(250) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE IF NOT EXISTS bookings (
    booking_id INT AUTO_INCREMENT PRIMARY KEY,
    userId INT NOT NULL,
    destinationId INT NOT NULL,
    bookingStatus VARCHAR(100) NOT NULL,
    bookingDate DATE NOT NULL,
    FOREIGN KEY (userId) REFERENCES users(id),
    FOREIGN KEY (destinationId) REFERENCES destinations(destinationId)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `towns` (`townCode`, `townName`, `districtCode`) VALUES
('0001', 'H\'Attard', '11'),
('0002', 'Hal Balzan', '08'),
('0003', 'Birkirkara', '08'),
('0004', 'Birzebbuga', '05'),
('0006', 'Burmarrad, San Pawl il-Bahar', '11'),
('0008', 'Bormla', '02'),
('0009', 'Had-Dingli', '07'),
('0010', 'Il-Fgura', '04'),
('0012', 'Floriana', '01'),
('0013', 'Il-Fontana', '13'),
('0014', 'Ghajnsielem', '13'),
('0015', 'L-Gharb', '13'),
('0016', 'Hal Gharghur', '09'),
('0018', 'L-Ghasri', '13'),
('0020', 'Hal Ghaxaq', '03'),
('0021', 'Gwardamanga, Tal-Pieta\'', '01'),
('0022', 'Il-Gudja', '04'),
('0023', 'Il-Gzira', '10'),
('0024', 'Ta\' Xbiex', '09'),
('0025', 'Il-Hamrun', '01'),
('0027', 'Il-Kalkara', '02'),
('0028', 'Ta\' Kercem', '13'),
('0029', 'Hal Kirkop', '05'),
('0030', 'Hal Lija', '08'),
('0031', 'Hal Luqa', '06'),
('0032', 'Il-Marsa', '01'),
('0035', 'Marsalforn, Iz-Zebbug (Ghawdex)', '13'),
('0036', 'Marsaskala', '03'),
('0037', 'Marsaxlokk', '03'),
('0038', 'L-Imdina', '11'),
('0039', 'Il-Mellieha', '12'),
('0041', 'L-Imgarr', '07'),
('0042', 'Il-Mosta', '11'),
('0043', 'L-Imqabba', '05'),
('0044', 'L-Imsida', '09'),
('0045', 'Il-Munxar', '13'),
('0046', 'In-Nadur', '13'),
('0047', 'In-Naxxar', '12'),
('0048', 'Paola', '04'),
('0050', 'Tal-Pieta\'', '01'),
('0051', 'Il-Qala', '13'),
('0052', 'Hal Qormi', '06'),
('0053', 'Il-Qrendi', '05'),
('0054', 'Ir-Rabat (Malta)', '07'),
('0055', 'Il-Bahrija, Ir-Rabat (Malta)', '07'),
('0056', 'Hal Safi', '05'),
('0057', 'San Gwann', '09'),
('0058', 'San Lawrenz', '13'),
('0059', 'Ta\' Sannat', '13'),
('0060', 'Santa Lucija, Ta\' Kercem', '13'),
('0061', 'Santa Lucija', '04'),
('0063', 'L-Isla', '02'),
('0064', 'Is-Siggiewi', '06'),
('0065', 'Tas-Sliema', '10'),
('0066', 'San Giljan', '10'),
('0067', 'San Pawl il-Bahar', '12'),
('0068', 'Hal Tarxien', '04'),
('0070', 'Il-Belt Valletta', '01'),
('0071', 'Ir-Rabat (Ghawdex)', '13'),
('0072', 'Il-Birgu', '02'),
('0073', 'Ix-Xaghra', '13'),
('0074', 'Ix-Xewkija', '13'),
('0075', 'Ix-Xghajra', '02'),
('0076', 'Xlendi, Il-Munxar', '13'),
('0077', 'Haz-Zabbar', '02'),
('0078', 'Iz-Zebbug (Ghawdex)', '13'),
('0079', 'Haz-Zebbug (Malta)', '07'),
('0080', 'Iz-Zejtun', '03'),
('0081', 'Iz-Zurrieq', '05'),
('0082', 'Bubaqra, Iz-Zurrieq', '05'),
('0083', 'L-Imtarfa', '07'),
('0084', 'Paceville, San Giljan', '10'),
('0085', 'Is-Swieqi', '09'),
('0086', 'Fleur-de-Lys, Birkirkara', '08'),
('0088', 'Tal-Virtu, Ir-Rabat (Malta)', '07'),
('0090', 'Santa Venera', '01'),
('0091', 'L-Iklin', '08'),
('0093', 'Madliena, Is-Swieqi', '09'),
('0096', 'Kappara, San Gwann', '09'),
('0097', 'Bahar ic-Caghaq, In-Naxxar', '10'),
('0098', 'Pembroke', '10'),
('0099', 'Hal Farrug, Hal Luqa', '05'),
('0100', 'St Peter\'s, Haz-Zabbar', '02'),
('0101', 'Is-Swatar, Birkirkara', '08'),
('0102', 'Is-Swatar, L-Imsida', '09'),
('0103', 'Parti mill-Fgura', '02'),
('0104', 'Parti min-Naxxar', '10'),
('0105', 'Parti minn Haz-Zebbug (Malta)', '06');

INSERT INTO roles (role_name) VALUES 
('admin'),
('driver'),
('user');

INSERT INTO `streets` (`streetCode`, `townCode`, `streetName`, `streetLongitude`, `streetLatitude`) VALUES
('00410019', '0044', 'Triq Censu Vella', NULL, NULL),
('00440001', '0102', 'Triq il- Gostra', 14.47677000, 35.89621000),
('00440003', '0044', 'Sqaq Clarence', NULL, NULL),
('00440006', '0044', 'Triq Omm Sidna', NULL, NULL),
('00440008', '0044', 'Triq l-Ghajn tal-Hasselin', NULL, NULL),
('00440009', '0044', 'Triq Dun Andre\' Debono', NULL, NULL),
('00440010', '0044', 'Triq Roberto Ranieri Costaguti', NULL, NULL),
('00440015', '0044', 'Triq Achille Ferris', 14.48594000, 35.89880000),
('00440018', '0044', 'Triq San Guzepp', 14.49377000, 35.89102000),
('00440028', '0044', 'Triq Antonio Bosio', 14.49059000, 35.89754000),
('00440031', '0044', 'Triq Antonio Sciortino', 14.49234000, 35.89799000),
('00440047', '0044', 'Triq il- Bacir', 14.49014000, 35.89402000),
('00440050', '0044', 'Misrah G. Debono', NULL, NULL),
('00440057', '0044', 'Triq Johnny Catania', 14.48885000, 35.89710000),
('00440060', '0044', 'Triq D\'Argens', 14.49439000, 35.90855000),
('00440086', '0044', 'Triq l-Isqof F.S. Caruana', 14.48902000, 35.89941000),
('00440099', '0044', 'Trejqa Ta\' Boxbox', NULL, NULL),
('00440106', '0044', 'Triq il-Harrub', 14.48384000, 35.89438000),
('00440119', '0044', 'Sqaq Casolani', 14.49150000, 35.89764000),
('00440122', '0044', 'Triq il-Knisja', 14.49102000, 35.89729000),
('00440141', '0044', 'Triq Oscar Zammit', 14.48826000, 35.89301000),
('00440148', '0044', 'Triq l-Esperanto', 14.48453000, 35.90075000),
('00440164', '0044', 'Triq Garcin', 14.48729000, 35.89577000),
('00440177', '0044', 'Triq Censu Farrugia', 14.48734000, 35.89450000),
('00440180', '0044', 'Triq Gioacchino Navarro', 14.49203000, 35.89724000),
('00440200', '0044', 'Triq Giovanni Schranz', 14.48957000, 35.90033000),
('00440213', '0044', 'Triq tal-Hriereb', 14.48664000, 35.90051000),
('00440226', '0044', 'Triq Tal- Hriereb, Sorijiet Frangiskani', 14.48664000, 35.90051000),
('00440239', '0044', 'Triq il-Kuncizzjoni', 14.48594000, 35.89731000),
('00440242', '0044', 'Triq il- Kuncizzjoni, Bini tal-Gvern', 14.48594000, 35.89731000),
('00440255', '0044', 'Triq L. Zamenhof', 14.48509000, 35.89727000),
('00440268', '0044', 'Triq il- Monsinjur Dandria', 14.49115000, 35.89785000),
('00440271', '0044', 'Triq Misrah il-Barrieri', 14.48866000, 35.89394000),
('00440284', '0044', 'Triq il- Monsinjur Falzon', 14.49024000, 35.89669000),
('00440297', '0044', 'Ic- Cirku ta\' l-Imsida', 14.48676800, 35.89952200),
('00440304', '0044', 'Xatt l-Imsida', 14.48760000, 35.89610000),
('00440317', '0044', 'Triq Gwann Mamo', 14.48787000, 35.89316000),
('00440319', '0044', 'Triq it-Torri', 14.48464000, 35.89720000),
('00440320', '0044', 'Triq id-Dejqa', 14.48692000, 35.89727000),
('00440333', '0044', 'Triq Victor Denaro', 14.48843000, 35.89955000),
('00440359', '0044', 'Triq Nazju Falzon', 14.48657000, 35.90040000),
('00440362', '0044', 'Triq Nazju Falzon, Dar Betania', 14.48657000, 35.90040000),
('00440376', '0044', 'Triq il-Qawsalla', 14.48420000, 35.89282000),
('00440388', '0044', 'Triq il-Parrocca', 14.48988000, 35.89647000),
('00440391', '0044', 'Triq il-Principessa Margerita', 14.49179000, 35.89904000),
('00440408', '0044', 'Triq tal-Qroqq', 14.48750000, 35.89933000),
('00440424', '0044', 'Triq Sant\'Antnin', 14.48957000, 35.89870000),
('00440437', '0044', 'Triq San Lwigi', 14.48831000, 35.89772000),
('00440440', '0044', 'Triq Santa Venera', 14.48475000, 35.89398000),
('00440443', '0044', 'Triq Bordin', 14.49019000, 35.89362000),
('00440453', '0044', 'Triq il-Makna tas-Serrar', 14.49083000, 35.89819000),
('00440456', '0044', 'Triq Clarence', 14.48913000, 35.89453000),
('00440466', '0044', 'Triq l-Iskola', 14.48777000, 35.89887000),
('00440479', '0044', 'Triq it-Tajjar', 14.49240000, 35.89812000),
('00440502', '0102', 'Triq it-Torri', 14.48464000, 35.89720000),
('00440515', '0044', 'Triq Mons. Carmelo Zammit, Dar Patri Manwel Magri', 14.48358000, 35.90035000),
('00440518', '0044', 'Triq J. Borg', 14.48920000, 35.89331000),
('00440528', '0044', 'Triq Ta\' Bieb it-Torri', 14.48809000, 35.90026000),
('00440531', '0044', 'Triq E.H. Furse', 14.48834000, 35.90065000),
('00440544', '0044', 'Triq l-Universita\'', 14.48749000, 35.90121000),
('00440557', '0044', 'Triq l-Ispizjar Joseph Sciberras', NULL, NULL),
('00440599', '0044', 'Triq il-Punent', 14.48594000, 35.89981000),
('00440606', '0044', 'Triq ix-Xatt Ta\' Xbiex', 14.49531000, 35.90125000),
('00440619', '0044', 'Triq Ta\' Xmiexi', 14.48520000, 35.89848000),
('00440622', '0044', 'Triq Zakkew', 14.48696000, 35.89867000),
('00440653', '0044', 'Triq il-Kunzar', 14.48592000, 35.89319000),
('00440664', '0044', 'Triq H. Calleja Schembri', 14.48633000, 35.89915000),
('00440677', '0044', 'Triq il-Karozzin', 14.48687000, 35.89572000),
('00440680', '0044', 'Triq Ta\' l- Gheriebel', 14.48662000, 35.89573000),
('00440693', '0044', 'Triq l-Irmigg', 14.48698000, 35.89527000),
('00440726', '0044', 'San Gwann tal-Ghorghar, Limiti ta\'', NULL, NULL),
('00440768', '0102', 'Triq Sant\'Andrija', 14.48287000, 35.89977000),
('00440817', '0102', 'Triq is-Swatar', 14.48002000, 35.89728000),
('00440820', '0102', 'Triq Mons. Arturo Bonnici', 14.47949000, 35.89692000),
('00440833', '0102', 'Triq Guze\' Ellul Mercer', 14.47893000, 35.89641000),
('00440846', '0102', 'Triq Indri Grima', 14.47897000, 35.89591000),
('00440859', '0102', 'Triq il-Balliju Guttenberg', 14.47873000, 35.89671000),
('00440888', '0044', 'Triq Dun Karm', 14.48331000, 35.89985000),
('00440891', '0044', 'Triq is-Sarg', 14.48406000, 35.89367000),
('00440911', '0102', 'Triq Giuseppe Calleja', 14.47912000, 35.89714000),
('00441161', '0044', 'Sqaq Santa Venera', 14.48516000, 35.89387000),
('00441185', '0044', 'Triq Anton Inglott', 14.48410000, 35.89333000),
('00441234', '0044', 'Sqaq Dun Guzepp Mifsud', 14.47951000, 35.90353000),
('00441236', '0044', 'Triq Mikiel Anton Vassalli', NULL, NULL),
('00441287', '0044', 'Triq il- Frangiskani', NULL, NULL),
('00441294', '0044', 'Triq is-Snajja\'', 14.48737000, 35.89301000),
('00441370', '0102', 'Triq Dijonisju Famucelli', 14.47395000, 35.91918000),
('00441383', '0044', 'Triq l- Imhallef Paolo Debono', 14.48423000, 35.90017000),
('00441396', '0044', 'Triq Dun Kalcidon Schembri', 14.48471000, 35.89321000),
('00441685', '0102', 'Triq Mons. Innocenz Zammit', 14.48257000, 35.89888000),
('00441919', '0044', 'Triq il- Wied ta\' l-Imsida, Jasmine Nursing Home', 14.48288000, 35.89461000),
('00441933', '0044', 'Triq Dun Joe Calleja', NULL, NULL),
('00442008', '0044', 'Triq Gemma Portelli', NULL, NULL),
('00442015', '0044', 'Triq il-Wied ta\' l-Imsida', 14.48568000, 35.89608000),
('00442099', '0044', 'Triq Emvin Cremona', NULL, NULL),
('00442151', '0044', 'Triq il- Principessa Margerita, Blk C1', 14.49179000, 35.89904000),
('00442177', '0044', 'Triq Mons. Carmelo Zammit', 14.48358000, 35.90035000),
('00442242', '0044', 'Triq Giorgio Mitrovich', 14.49125000, 35.90049000),
('00442320', '0102', 'Triq il- Balliju Guttenberg, Blk B, Ent. 1', 14.47873000, 35.89671000),
('00442549', '0044', 'Triq San Gwann tal-Ghorghar', 14.47958000, 35.90416000),
('00442622', '0044', 'Triq il- Principessa Margerita, Blk B2', 14.49179000, 35.89904000),
('00443619', '0044', 'Triq it- Tabib Robert Naudi', NULL, NULL),
('00444028', '0044', 'Triq C. De Brocktorff', 14.49021000, 35.90010000),
('00444677', '0044', 'Xatt l- Imsida, Marina Palace', 14.48760000, 35.89610000),
('00444771', '0102', 'Triq Guzeppi Maria Pugliesevich', 0.00000000, 0.00000000),
('00444924', '0044', 'Triq Michele Bellanti', 14.48972000, 35.90065000),
('01020001', '0102', 'Triq Guze\' Ellul Mercer, Ent. A', 14.47639260, 35.89633120),
('01020002', '0102', 'Triq Guze\' Ellul Mercer, Ent. B', 14.47639260, 35.89633120),
('01020003', '0102', 'Triq Guzeppi Maria Pugliesevich, Ent. C', 14.47751000, 35.89650000),
('01020004', '0102', 'Triq Guzeppi Maria Pugliesevich, Ent. D', 14.47751000, 35.89650000),
('01020005', '0102', 'Triq il- Gostra, Ent. E', 14.47677000, 35.89621000),
('01020006', '0102', 'Triq is-Sisla', 0.00000000, 0.00000000),
('01020007', '0102', 'Triq il-Logga', 0.00000000, 0.00000000),
('01020008', '0102', 'Trejqet Melita', 0.00000000, 0.00000000),
('01020009', '0102', 'Triq l-Ahwa Cefai', 0.00000000, 0.00000000),
('01021962', '0102', 'Triq il- Balliju Guttenberg, Blk A, Ent. 2', 14.47873000, 35.89671000),
('01029008', '0102', 'Triq San Gorg Preca, Blk 2B', NULL, NULL);

ALTER TABLE `streets`
  ADD PRIMARY KEY (`streetCode`),
  ADD KEY `FK_townCode` (`townCode`);

ALTER TABLE `streets`
  ADD CONSTRAINT `FK_townCode` FOREIGN KEY (`townCode`) REFERENCES `towns` (`townCode`);
COMMIT;